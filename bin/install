#!/usr/bin/env node

/* eslint no-var: 0 */
const HUSKY_ENV_NAME = 'USE_HUSKY';
var useHusky = process.env[HUSKY_ENV_NAME];


if (process.env.TEAMCITY_VERSION) {
  console.log('TeamCity Detected not installing the commit hook');
  process.exit(0); // eslint-disable-line no-process-exit
}

var path = require('path');
var fs = require('fs');
var exists = fs.existsSync(path.join(__dirname, '../lib'));

if (useHusky) {
  console.log(`${HUSKY_ENV_NAME} environment variable found. Hook installation will be skipped.`);
  console.log(
    "To complete installation, `npm install husky --save-dev` (if you haven't already) and then configure Husky with...",
    {
      "husky": {
        "hooks": {
          "commit-msg": "husky-jira-commit-msg"
        }
      }
    });


} else if (exists) {
  var install = require('../lib/install.js');

  install()
    .catch(function(err) {
      console.error(err);
      process.exit(1);
    });
}
